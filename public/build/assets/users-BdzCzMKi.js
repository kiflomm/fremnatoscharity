import{u as O,r as f,j as e,H as z,a as h}from"./app-wVpjM_Nk.js";import{C as g,a as w,b as v,c as N,d as P}from"./card-CGZKi39q.js";import{B as G}from"./badge-DD0iYaFX.js";import{B as i}from"./index-BY0DeOZ3.js";import{L as n,I as d}from"./label-B8PTkBuR.js";import{A as J,a as Q,b as K}from"./avatar-Dtbf_utt.js";import{A as W,D as X,a as Y,b as Z,d as F}from"./app-layout-s9lILmSr.js";import{S as ee,a as se,b as ae,c as re,d as k}from"./select-RPATrJT9.js";import{D as y,e as le,a as b,b as C,c as D,d as S}from"./dialog-C-P_W27A.js";import{P as te,E as ie}from"./plus-CJvZT1S0.js";import{L as ne}from"./loader-circle-BXXRtvbN.js";import{U as de}from"./index-B_IgmGSB.js";import{S as A}from"./shield-Bnyk0d9H.js";import{U as E}from"./user-D6mZ1ceA.js";import{S as oe}from"./search-Cx-7Ya6m.js";import{M as ce}from"./mail-BYldFupc.js";import{C as me}from"./calendar-Ccyl5jZg.js";/* empty css            */import"./index-ii9NU5RA.js";import"./index-CFm55Yc-.js";import"./log-out-BQgglRgp.js";import"./heart-CsAA20Wh.js";import"./message-square-Ci_Kvfwa.js";const xe=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Users",href:"/admin/users"}];function Re({users:p,totalUsers:L,editorUsers:M,guestUsers:R}){const T=s=>{const t={admin:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",editor:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",guest:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"};return t[s]||t.guest},$=s=>({admin:A,editor:A,guest:E})[s]||E,{data:l,setData:a,post:q,processing:U,reset:I,errors:m,delete:B}=O({name:"",email:"",password:"",password_confirmation:"",role:"editor"}),[u,o]=f.useState({type:null,userId:null}),r=f.useMemo(()=>p.find(s=>s.id===u.userId)||null,[p,u.userId]),[j,V]=f.useState(""),_=f.useMemo(()=>{if(!j.trim())return p;const s=j.trim().toLowerCase();return p.filter(t=>t.name.toLowerCase().includes(s)||t.email.toLowerCase().includes(s)||t.role.toLowerCase().includes(s))},[p,j]),x=()=>o({type:null,userId:null}),H=s=>{s.preventDefault(),q("/admin/users",{onSuccess:()=>{I("name","email","password","password_confirmation"),h.reload({only:["users","totalUsers"]})}})};return e.jsxs(W,{breadcrumbs:xe,children:[e.jsx(z,{title:"Admin - Users"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, and permissions"})]}),e.jsxs(y,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(i,{className:"w-full sm:w-auto","aria-label":"Add editor",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Add Editor"]})}),e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(D,{children:"Add a new editor"})}),e.jsxs("form",{className:"space-y-4",onSubmit:H,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"Full name"}),e.jsx(d,{id:"name",name:"name",value:l.name,onChange:s=>a("name",s.target.value),required:!0,autoFocus:!0}),m?.name&&e.jsx("p",{className:"text-sm text-red-600",children:m.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",type:"email",name:"email",value:l.email,onChange:s=>a("email",s.target.value),required:!0}),m?.email&&e.jsx("p",{className:"text-sm text-red-600",children:m.email})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password",children:"Password"}),e.jsx(d,{id:"password",type:"password",name:"password",value:l.password,onChange:s=>a("password",s.target.value),required:!0}),m?.password&&e.jsx("p",{className:"text-sm text-red-600",children:m.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(d,{id:"password_confirmation",type:"password",name:"password_confirmation",value:l.password_confirmation,onChange:s=>a("password_confirmation",s.target.value),required:!0})]})]}),e.jsx(S,{children:e.jsx(i,{type:"submit",disabled:U,className:"w-full sm:w-auto",children:U?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Editor"})})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(g,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(de,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:L}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All registered users"})]})]}),e.jsxs(g,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium",children:"Editors"}),e.jsx(A,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Users with editor privileges"})]})]}),e.jsxs(g,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium",children:"Guests"}),e.jsx(E,{className:"h-4 w-4 text-gray-600"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:R}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Users without elevated access"})]})]})]}),e.jsxs(g,{children:[e.jsxs(w,{children:[e.jsx(v,{children:"Users"}),e.jsx(P,{children:"A list of all users in the system"}),e.jsx("div",{className:"flex items-center gap-2 max-sm:flex-col sm:justify-between",children:e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx(oe,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(d,{placeholder:"Search users by name, email, or role...","aria-label":"Search users",value:j,onChange:s=>V(s.target.value),className:"pl-8 w-full sm:w-[300px]"})]})})]}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[_.length===0&&e.jsx("div",{className:"text-center text-sm text-muted-foreground py-10",children:"No users found."}),_.map(s=>{const t=$(s.role);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(J,{children:[e.jsx(Q,{src:s.avatar,alt:s.name}),e.jsx(K,{children:s.name.split(" ").map(c=>c[0]).join("")})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs(G,{className:T(s.role),children:[e.jsx(t,{className:"mr-1 h-3 w-3"}),s.role]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"mr-1 h-3 w-3"}),s.email]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"mr-1 h-3 w-3"}),"Joined ",new Date(s.created_at).toLocaleDateString()]})]})]})]}),s.role!=="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row sm:hidden w-full justify-around",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{a("name",s.name),a("email",s.email),a("password",""),a("password_confirmation",""),o({type:"edit",userId:s.id})},"aria-label":`Edit ${s.name}`,children:"Edit"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{a("role",s.role),o({type:"role",userId:s.id})},"aria-label":`Change role for ${s.name}`,children:"Role"}),e.jsx(i,{variant:"destructive",size:"sm",onClick:()=>{o({type:"delete",userId:s.id})},"aria-label":`Delete ${s.name}`,children:"Delete"})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(i,{variant:"ghost",className:"h-9 w-9 p-0","aria-label":`Open actions for ${s.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(Z,{align:"end",children:[e.jsx(F,{onSelect:c=>{c.preventDefault(),a("name",s.name),a("email",s.email),a("password",""),a("password_confirmation",""),o({type:"edit",userId:s.id})},children:"Edit User"}),e.jsx(F,{onSelect:c=>{c.preventDefault(),a("role",s.role),o({type:"role",userId:s.id})},children:"Change Role"}),e.jsx(F,{className:"text-red-600",onSelect:c=>{c.preventDefault(),o({type:"delete",userId:s.id})},children:"Delete User"})]})]})})]})]},s.id)})]})})]}),e.jsx(y,{open:u.type==="edit",onOpenChange:s=>{s||x()},children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(D,{children:"Edit user"})}),e.jsxs("form",{className:"space-y-4",onSubmit:s=>{s.preventDefault(),r&&h.put(`/admin/users/${r.id}`,{name:l.name||r.name,email:l.email||r.email,password:l.password,password_confirmation:l.password_confirmation},{onSuccess:()=>{I("name","email","password","password_confirmation"),h.reload({only:["users"]}),x()}})},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name-edit",children:"Full name"}),e.jsx(d,{id:"name-edit",defaultValue:r?.name,onChange:s=>a("name",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email-edit",children:"Email"}),e.jsx(d,{id:"email-edit",type:"email",defaultValue:r?.email,onChange:s=>a("email",s.target.value)})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password-edit",children:"New password (optional)"}),e.jsx(d,{id:"password-edit",type:"password",onChange:s=>a("password",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password2-edit",children:"Confirm password"}),e.jsx(d,{id:"password2-edit",type:"password",onChange:s=>a("password_confirmation",s.target.value)})]})]}),e.jsx(S,{children:e.jsx(i,{type:"submit",disabled:U,children:"Save changes"})})]})]})}),e.jsx(y,{open:u.type==="role",onOpenChange:s=>{s||x()},children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(D,{children:"Change role"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Role"}),e.jsxs(ee,{defaultValue:r?.role==="admin"?"editor":r?.role,onValueChange:s=>a("role",s),children:[e.jsx(se,{children:e.jsx(ae,{placeholder:"Select a role"})}),e.jsxs(re,{children:[e.jsx(k,{value:"editor",children:"Editor"}),e.jsx(k,{value:"guest",children:"Guest"})]})]})]}),e.jsx(S,{children:e.jsx(i,{onClick:()=>{r&&h.put(`/admin/users/${r.id}/role`,{role:l.role||r.role},{onSuccess:()=>{I("role"),h.reload({only:["users"]}),x()}})},children:"Update role"})})]})]})}),e.jsx(y,{open:u.type==="delete",onOpenChange:s=>{s||x()},children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(D,{children:"Delete user"})}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This action is irreversible. Are you sure you want to delete ",r?.name,"?"]}),e.jsx(S,{children:e.jsx(i,{variant:"destructive",onClick:()=>{r&&B(`/admin/users/${r.id}`,{onSuccess:()=>{h.reload({only:["users","totalUsers"]}),x()}})},children:"Delete"})})]})})]})]})}export{Re as default};
